<% @recipe.procedure.order("number ASC").each_with_index do |procedure,i| %>
    <div class="procedure-list flex flex-left">
      <%= render "procedures_show", {i: i, procedure: procedure} %>
    </div>
    <dt><a>手順を変更する</a></dt>
    <dd>
      <div class="flex">
        <div>
          <%= "#{(i+1)}"%>:
        </div>
        <div class="procedure-input-textarea">
          <%= form_with model: @procedure, url: procedures_path do |form| %>
            <%= hidden_field_tag :recipe_id, @recipe.id %>
            <%= form.text_area :content, placeholder: "手順を入力しましょう", value: procedure.content if procedure.content.present? %>
            <%= form.hidden_field :number, value: "#{(i+1)}" %>
            <%= form.submit "保存" %>
          <% end %>
        </div>
        
        <div class="flex flex-end">
          <% unless i == 0 %>
            <%= form_with url: procedures_change_before_path do |form| %>
              <%= hidden_field_tag :recipe_id, @recipe.id %>
              <%= hidden_field_tag :number, procedure.number %>
              <%= form.submit "↑", class: "change_content_button" %>
            <% end %>
          <% end %>
          
          <% unless i == @recipe.procedure.count - 1 %>
            <%= form_with url: procedures_change_after_path do |form| %>
              <%= hidden_field_tag :recipe_id, @recipe.id %>
              <%= hidden_field_tag :number, procedure.number %>
              <%= form.submit "↓", class: "change_content_button" %>
            <% end %>
          <% end %>
        </div>
      </div>
    </dd>
<% end %>